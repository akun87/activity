<mxfile host="app.diagrams.net" modified="2021-07-11T12:13:17.510Z" agent="5.0 (Macintosh)" etag="IaRRUpbhTtjYeUSKLIsI" version="14.8.5" type="github">
  <diagram id="U2JTOIulrzN3h3iKnZu4" name="第 1 页">
    <mxGraphModel dx="946" dy="-1937" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="MWvZi_O0qiYePcI-Mjma-18" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;exitX=0.5;exitY=0.9;exitPerimeter=0;fontStyle=1;strokeColor=#003366;strokeWidth=1;html=1;entryX=0.542;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry x="640.5" y="2641" width="100" height="100" as="geometry">
            <mxPoint x="961" y="3642" as="sourcePoint" />
            <mxPoint x="961" y="3731" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-20" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;fontStyle=1;strokeColor=#003366;strokeWidth=1;html=1;" parent="1" edge="1">
          <mxGeometry x="640.5" y="2601" width="100" height="100" as="geometry">
            <mxPoint x="962" y="3781" as="sourcePoint" />
            <mxPoint x="962" y="3851" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-26" value="" style="edgeStyle=elbowEdgeStyle;elbow=vertical;exitX=1;exitY=0.5;exitPerimeter=0;fontStyle=1;strokeColor=#003366;strokeWidth=1;html=1;" parent="1" edge="1">
          <mxGeometry x="635.5" y="2501" width="100" height="100" as="geometry">
            <mxPoint x="1276" y="3761" as="sourcePoint" />
            <mxPoint x="1276" y="3761" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-27" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gocron模板任务事件&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;" style="shape=mxgraph.flowchart.terminator;strokeWidth=2;gradientDirection=north;fontStyle=0;html=1;" parent="1" vertex="1">
          <mxGeometry x="905.5" y="3571" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-28" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;查询模板任务&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="3730" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-32" value="目的解决多台服务，重复处理问题" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;size=25;position=0.72;position2=1;base=20;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="790" y="3810" width="96" height="69" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-40" value="模板任务事件 每1分钟执行一次" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="720" y="3450" width="645" height="70" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-41" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;从DB查询未发送并到期的模板任务&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="3730" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-42" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Redis&lt;br&gt;&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;#34;jetbrains mono&amp;#34; ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #36666b&quot;&gt;SetNX 分布式锁&lt;/span&gt;&lt;/pre&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="3850" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-46" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="959.5" y="3910" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-46" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;从DB查询&lt;span style=&quot;color: #80118c&quot;&gt; 总条数&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #336ecc&quot;&gt;DeviceToken&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="3970" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-50" value="没有数据终止进行" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="3730" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-51" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1020" y="3758" as="sourcePoint" />
            <mxPoint x="1110" y="3758" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-52" value="没有数据&lt;br&gt;修改模板任务状态&lt;br&gt;释放分锁终止进行" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="3970" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-53" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1020" y="3998" as="sourcePoint" />
            <mxPoint x="1110" y="3998" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-54" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;分页 页码存入 redis&lt;span style=&quot;color: #36666b&quot;&gt;&lt;br&gt;LPush&lt;/span&gt;&lt;span style=&quot;color: #36666b&quot;&gt; 队列&lt;/span&gt;&lt;span style=&quot;color: #336ecc&quot;&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="4090" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-55" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-54" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="959.5" y="4030" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-56" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-57" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="959.5" y="4150" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-62" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="MWvZi_O0qiYePcI-Mjma-57" target="MWvZi_O0qiYePcI-Mjma-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-57" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;模板任务信息存入 redis&lt;span style=&quot;color: #067d17&quot;&gt;&amp;nbsp; hmset &lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="4210" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-60" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-61" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="959.5" y="4270" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-61" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;释放redis分布式锁&lt;br&gt;&lt;/div&gt;&lt;span style=&quot;color: #067d17&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #336ecc&quot;&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="4330" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-63" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-64" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="959.5" y="4390" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-64" value="企业微信报警通知提醒" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="899" y="4450" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-65" value="每页300条&lt;span style=&quot;color: #067d17&quot;&gt;&lt;br&gt;list类型&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;size=25;position=0.72;position2=1;base=20;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="790" y="4060" width="96" height="69" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-66" value="&lt;span style=&quot;color: #067d17&quot;&gt;hash类型&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;size=25;position=0.72;position2=1;base=20;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="790" y="4180" width="96" height="69" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-67" value="DB" style="shape=cylinder;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;fillColor=#dae8fc;strokeColor=#6c8ebf;gradientColor=#7ea6e0;" parent="1" vertex="1">
          <mxGeometry x="1271" y="3952" width="119" height="338" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-68" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1130" y="4239" as="sourcePoint" />
            <mxPoint x="1271" y="4239" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-69" value="|&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color: #067d17&quot;&gt;模板任务表变更状态和总条数&lt;/span&gt;&lt;span style=&quot;color: #336ecc&quot;&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1110" y="4209" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-70" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1020" y="4238" as="sourcePoint" />
            <mxPoint x="1110" y="4238" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-72" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1230" y="4000" as="sourcePoint" />
            <mxPoint x="1271" y="3999.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-106" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;exitX=0.5;exitY=0.9;exitPerimeter=0;fontStyle=1;strokeColor=#003366;strokeWidth=1;html=1;entryX=0.542;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry x="615.5" y="4021" width="100" height="100" as="geometry">
            <mxPoint x="936" y="5022" as="sourcePoint" />
            <mxPoint x="936" y="5111" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-107" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;fontStyle=1;strokeColor=#003366;strokeWidth=1;html=1;" parent="1" edge="1">
          <mxGeometry x="615.5" y="3981" width="100" height="100" as="geometry">
            <mxPoint x="937" y="5161" as="sourcePoint" />
            <mxPoint x="937" y="5231" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-108" value="" style="edgeStyle=elbowEdgeStyle;elbow=vertical;exitX=1;exitY=0.5;exitPerimeter=0;fontStyle=1;strokeColor=#003366;strokeWidth=1;html=1;" parent="1" edge="1">
          <mxGeometry x="610.5" y="3881" width="100" height="100" as="geometry">
            <mxPoint x="1251" y="5141" as="sourcePoint" />
            <mxPoint x="1251" y="5141" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-109" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gocron&lt;br&gt;推送消息任务事件&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;" style="shape=mxgraph.flowchart.terminator;strokeWidth=2;gradientDirection=north;fontStyle=0;html=1;" parent="1" vertex="1">
          <mxGeometry x="880.5" y="4951" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-110" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;查询模板任务&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5110" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-112" value="消息推送任务事件 每6秒执行一次，一次3000条" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="695" y="4830" width="645" height="70" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-113" value="读取 redis&lt;span style=&quot;color: #067d17&quot;&gt;&lt;br&gt;hgetall 模板任务信息&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5110" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-114" value="消费队列页码 &lt;br&gt;redis&lt;span style=&quot;color: #36666b&quot;&gt; RPop&lt;/span&gt;&lt;span style=&quot;color: #36666b&quot;&gt; 队列&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5230" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-115" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-116" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="934.5" y="5290" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-116" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;从DB查询&lt;span style=&quot;color: #80118c&quot;&gt; &lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #336ecc&quot;&gt;DeviceToken&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5350" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-119" value="没有数据终止进行" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1085" y="5110" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-120" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="995" y="5138" as="sourcePoint" />
            <mxPoint x="1085" y="5138" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-123" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;redis&lt;span style=&quot;color: #000000&quot;&gt;&lt;br&gt;DeviceToken 存储&lt;/span&gt;&lt;span style=&quot;color: #36666b&quot;&gt; SAdd&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;color: #36666b&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #336ecc&quot;&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5470" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-124" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-123" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="934.5" y="5410" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-125" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-127" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="934.5" y="5530" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-126" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="MWvZi_O0qiYePcI-Mjma-127" target="MWvZi_O0qiYePcI-Mjma-129" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-127" value="拆分每批次&lt;br&gt;500条" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5590" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-128" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-129" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="934.5" y="5650" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-129" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;#34;jetbrains mono&amp;#34; ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #80118c&quot;&gt;ios、&lt;/span&gt;&lt;span style=&quot;color: #80118c&quot;&gt;android &lt;br&gt;开始推送&lt;/span&gt;&lt;/pre&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5710" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-130" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-131" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="934.5" y="5770" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-131" value="队列消费完成&lt;br&gt;释放模板任务&lt;span style=&quot;color: #36666b&quot;&gt;HDel&lt;br&gt;释放set del&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5830" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-132" value="&lt;span style=&quot;color: #067d17&quot;&gt;&lt;br&gt;采用set 类型&lt;br&gt;防止重复&lt;br&gt;&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;size=25;position=0.72;position2=1;base=20;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="765" y="5440" width="96" height="69" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-133" value="友盟限制500条" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;size=25;position=0.72;position2=1;base=20;rotation=-30;" parent="1" vertex="1">
          <mxGeometry x="765" y="5560" width="96" height="69" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-134" value="DB" style="shape=cylinder;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;fillColor=#dae8fc;strokeColor=#6c8ebf;gradientColor=#7ea6e0;" parent="1" vertex="1">
          <mxGeometry x="1246" y="5571" width="119" height="338" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-135" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1105" y="5619" as="sourcePoint" />
            <mxPoint x="1246" y="5619" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-136" value="插入要推送的数据" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1085" y="5589" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-137" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="995" y="5618" as="sourcePoint" />
            <mxPoint x="1085" y="5618" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-139" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1000.5" y="5729" as="sourcePoint" />
            <mxPoint x="1080" y="5729" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-140" value="如果推送失败&lt;br&gt;已推送数据改为失败状态" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1085" y="5700" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-141" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1206" y="5730" as="sourcePoint" />
            <mxPoint x="1247.5" y="5730" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-146" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="MWvZi_O0qiYePcI-Mjma-147" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="934.5" y="5890" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-147" value="企业微信报警通知提醒发送完成及发送情况" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="874" y="5950" width="121" height="60" as="geometry" />
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-152" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1110.5" y="5860" as="sourcePoint" />
            <mxPoint x="1251.5" y="5860" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-153" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1000.5" y="5859" as="sourcePoint" />
            <mxPoint x="1090.5" y="5859" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="MWvZi_O0qiYePcI-Mjma-154" value="修改模板任务状态为成功完成&lt;br&gt;及发送成功数、失败数" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1090.5" y="5830" width="120" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
